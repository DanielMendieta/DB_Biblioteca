1- Función para obtener el total de ventas de clientes específicos:

CREATE FUNCTION TotalComprasCliente (ClienteID INT)
RETURNS DECIMAL(10, 2)
BEGIN
    DECLARE total DECIMAL(10, 2);
    SELECT SUM(V.Total) INTO total
    FROM Ventas V
    WHERE V.ClienteID = ClienteID;
    RETURN total;
END;

SELECT TotalComprasCliente(1) AS Total_Compras;  -- Llamar a la funcion 

-----------------------------------------------------------------------------------

2- Función para obtener el total de libros comprados por clientes específicos:

CREATE FUNCTION TotalLibrosCompradosCliente (ClienteID INT)
RETURNS INT
BEGIN
    DECLARE total INT;
    SELECT SUM(DV.Cantidad) INTO total
    FROM Ventas V
    JOIN DetallesVentas DV ON V.ID = DV.VentaID
    WHERE V.ClienteID = ClienteID;
    RETURN total;
END;

SELECT TotalLibrosCompradosCliente(2) AS Total_Libros_Comprados; -- Llamar a la funcion 
